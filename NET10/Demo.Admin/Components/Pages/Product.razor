@page "/Product"

<h3>Product</h3>

<div class="d-flex align-center gap-3 mb-4">
    <MudTextField @bind-Value="_searchTerm" Label="Search by Name" Variant="Variant.Outlined" Class="flex-grow-1" Margin="Margin.Dense" />
    <MudAutocomplete T="Demo.Application.DTO.Company.CompanyDto"
                     Value="_selectedCompany"
                     ValueChanged="@OnCompanySelectionChanged"
                     SearchFunc="@SearchCompanies"
                     ToStringFunc="@(e => e?.Name ?? "")"
                     Label="Company Filter"
                     Variant="Variant.Outlined"
                     Clearable="true"
                     Class="flex-grow-1"
                     Margin="Margin.Dense"
                     ShowProgressIndicator="true"
                     ProgressIndicatorColor="Color.Primary"
                     AdornmentIcon="@Icons.Material.Filled.Business"
                     AdornmentColor="Color.Primary"
                     ResetValueOnEmptyText="true"
                     CoerceText="false"
                     MaxItems="50">
        <ItemTemplate Context="company">
            <MudText>@company.Name</MudText>
            <MudText Typo="Typo.caption" Style="color: var(--mud-palette-text-secondary);">ID: @company.Id</MudText>
        </ItemTemplate>
        <NoItemsTemplate>
            <MudText Align="Align.Center" Class="px-4 py-1">
                검색 결과가 없습니다
            </MudText>
        </NoItemsTemplate>
    </MudAutocomplete>
    <MudButton Variant="Variant.Filled" Color="Color.Primary" StartIcon="@Icons.Material.Filled.Search" OnClick="OnSearchAsync" Size="Size.Small">Search</MudButton>
    <MudButton Variant="Variant.Filled" Color="Color.Success" StartIcon="@Icons.Material.Filled.Add" OnClick="OnCreateProductAsync" Size="Size.Small">생성</MudButton>
</div>

<MudDataGrid ServerData="LoadGridData" T="Demo.Application.DTO.Product.ProductDto" @ref="_dataGrid" Dense="true" Hover="true"
    Bordered="true" Striped="false" Elevation="0">
    <Columns>
        <PropertyColumn Property="x => x.Id" Title="Id" />
        <PropertyColumn Property="x => x.Name" Title="Product Name" />
        <PropertyColumn Property="x => x.CompanyName" Title="Company" />
        <PropertyColumn Property="x => x.Price" Title="Price" Format="N0" />
        <PropertyColumn Property="x => x.CreatedAt" Title="Created At" />
    </Columns>
    <PagerContent>
        <MudDataGridPager T="Demo.Application.DTO.Product.ProductDto" Disabled="false" />
    </PagerContent>
</MudDataGrid>